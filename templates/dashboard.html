<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='main.js') }}"></script>
</head>
<body>

<div class="container">
    <h1>Welcome {{ username }}</h1>

    <!-- ===== STATS CARDS ===== -->
    <div style="display:grid; grid-template-columns:repeat(4,1fr); gap:15px; margin-bottom:25px;">
        <div class="card">ğŸ“ Projects<br><strong>{{ total_projects }}</strong></div>
        <div class="card">ğŸ“‹ Tasks<br><strong>{{ total_tasks }}</strong></div>
        <div class="card">ğŸš§ In Progress<br><strong>{{ in_progress }}</strong></div>
        <div class="card">âœ… Completed<br><strong>{{ completed }}</strong></div>
    </div>

    <div style="text-align:center; margin-bottom:20px;">
        <a href="{{ url_for('new_project') }}"><button>Add New Project</button></a>
        <a href="{{ url_for('logout') }}"><button>Logout</button></a>
    </div>

    <!-- ===== PROJECTS ===== -->
    {% for project in projects %}
    <div class="project-box">
        <h3>{{ project.name }}</h3>
        <p>{{ project.description }}</p>

        Progress: {{ project.progress }}%
        <progress value="{{ project.progress }}" max="100"></progress>

        <div style="margin-top:10px;">
            <button onclick="toggleTasks('tasks-{{ project.id }}')">View Tasks</button>
            <a href="{{ url_for('new_task', project_id=project.id) }}"><button>Add Task</button></a>
        </div>

        <!-- TASK LIST -->
        <ul id="tasks-{{ project.id }}" style="display:none; margin-top:10px;">
            {% for task in project.tasks %}
            <li>
                {{ task.title }} - {{ task.status }}
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endfor %}

</div>

<script>
function toggleTasks(id){
    const el = document.getElementById(id);
    el.style.display = el.style.display === 'none' ? 'block' : 'none';
}
</script>

</body>
</html>
